
    @Test
    void testCreateAbCustomer_Success() throws Exception {
        // Arrange
        CustomerAbResponse customerResponse = new CustomerAbResponse();
        customerResponse.setCustomerId("CUST123");
        customerResponse.setGlobalId("GLOBAL123");

        when(dbLogger.logIntoDb(any(), any(), any(), any())).thenReturn(logChannel);
        when(partyService.createAbTransaction(any(), any(), any(), any())).thenReturn(customerResponse);
        when(objectMapper.writeValueAsString(any())).thenReturn("{\"customerId\":\"CUST123\"}");

        // Act
        CustomerAbResponse result = mainService.createAbCustomer(newPartyModel, headers, "identifier");

        // Assert
        assertThat(result).isNotNull();
        assertThat(result.getCustomerId()).isEqualTo("CUST123");

        verify(dbLogger).updateLogChannelOutput(
                eq("{\"customerId\":\"CUST123\"}"),
                eq(HttpStatus.CREATED.name()),
                eq(HttpStatus.CREATED.value()),
                eq(logChannel)
        );
    }
